<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Changing the Git history of your repository using a script - Simon (Yu Ma)</title><meta name=Description content="Progress is the activity of today and the assurance of tomorrow."><meta property="og:title" content="Changing the Git history of your repository using a script"><meta property="og:description" content="We&rsquo;ve created a script that will change any commits that previously had the old email address in its author or committer fields to use the correct name and email address.
 Note: Running this script rewrites history for all repository collaborators. After completing these steps, any person with forks or clones must fetch the rewritten history and rebase any local changes into the rewritten history.
 Before running this script, you&rsquo;ll need:"><meta property="og:type" content="article"><meta property="og:url" content="https://simonmy.com/posts/git-%E4%BF%AE%E6%AD%A3commit%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-08T18:00:00+08:00"><meta property="article:modified_time" content="2022-05-08T18:00:00+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Changing the Git history of your repository using a script"><meta name=twitter:description content="We&rsquo;ve created a script that will change any commits that previously had the old email address in its author or committer fields to use the correct name and email address.
 Note: Running this script rewrites history for all repository collaborators. After completing these steps, any person with forks or clones must fetch the rewritten history and rebase any local changes into the rewritten history.
 Before running this script, you&rsquo;ll need:"><meta name=application-name content="Simon (Yu Ma)"><meta name=apple-mobile-web-app-title content="Simon (Yu Ma)"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://simonmy.com/posts/git-%E4%BF%AE%E6%AD%A3commit%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF/><link rel=prev href=https://simonmy.com/posts/mac%E4%BD%BF%E7%94%A8tar%E5%91%BD%E4%BB%A4%E6%89%93%E5%8C%85%E5%A4%9A%E5%87%BA%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Changing the Git history of your repository using a script","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/simonmy.com\/posts\/git-%E4%BF%AE%E6%AD%A3commit%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF\/"},"genre":"posts","wordcount":234,"url":"https:\/\/simonmy.com\/posts\/git-%E4%BF%AE%E6%AD%A3commit%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF\/","datePublished":"2022-05-08T18:00:00+08:00","dateModified":"2022-05-08T18:00:00+08:00","publisher":{"@type":"Organization","name":"Simon (Yu Ma)"},"author":{"@type":"Person","name":"Simon (Yu Ma)"},"description":""}</script></head><body header-desktop header-mobile><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":''==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:''==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Simon (Yu Ma)">Simon (Yu Ma)</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Simon (Yu Ma)">Simon (Yu Ma)</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Changing the Git history of your repository using a script</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Simon (Yu Ma)</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-05-08>2022-05-08</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 234 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 2 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents></nav></div></div><div class=content id=content><p>We&rsquo;ve created a script that will change any commits that previously had the old email address in its author or committer fields to use the correct name and email address.</p><blockquote><p>Note: Running this script rewrites history for all repository collaborators. After completing these steps, any person with forks or clones must fetch the rewritten history and rebase any local changes into the rewritten history.</p></blockquote><p>Before running this script, you&rsquo;ll need:</p><p>The old email address that appears in the author/committer fields that you want to change
The correct name and email address that you would like such commits to be attributed to</p><ol><li><p>Open Terminal.</p></li><li><p>Create a fresh, bare clone of your repository:</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git clone --bare https://github.com/user/repo.git
</span></span><span class=line><span class=cl><span class=nb>cd</span> repo.git
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>Copy and paste the script, replacing the following variables based on the information you gathered:</li></ol><ul><li>OLD_EMAIL</li><li>CORRECT_NAME</li><li>CORRECT_EMAIL</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=cp>#!/bin/sh
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl>git filter-branch --env-filter <span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>OLD_EMAIL=&#34;your-old-email@example.com&#34;
</span></span></span><span class=line><span class=cl><span class=s1>CORRECT_NAME=&#34;Your Correct Name&#34;
</span></span></span><span class=line><span class=cl><span class=s1>CORRECT_EMAIL=&#34;your-correct-email@example.com&#34;
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>if [ &#34;$GIT_COMMITTER_EMAIL&#34; = &#34;$OLD_EMAIL&#34; ]
</span></span></span><span class=line><span class=cl><span class=s1>then
</span></span></span><span class=line><span class=cl><span class=s1>export GIT_COMMITTER_NAME=&#34;$CORRECT_NAME&#34;
</span></span></span><span class=line><span class=cl><span class=s1>export GIT_COMMITTER_EMAIL=&#34;$CORRECT_EMAIL&#34;
</span></span></span><span class=line><span class=cl><span class=s1>fi
</span></span></span><span class=line><span class=cl><span class=s1>if [ &#34;$GIT_AUTHOR_EMAIL&#34; = &#34;$OLD_EMAIL&#34; ]
</span></span></span><span class=line><span class=cl><span class=s1>then
</span></span></span><span class=line><span class=cl><span class=s1>export GIT_AUTHOR_NAME=&#34;$CORRECT_NAME&#34;
</span></span></span><span class=line><span class=cl><span class=s1>export GIT_AUTHOR_EMAIL=&#34;$CORRECT_EMAIL&#34;
</span></span></span><span class=line><span class=cl><span class=s1>fi
</span></span></span><span class=line><span class=cl><span class=s1>&#39;</span> --tag-name-filter cat -- --branches --tags
</span></span></code></pre></td></tr></table></div></div><ol start=4><li><p>Press Enter to run the script.</p></li><li><p>Review the new Git history for errors.</p></li><li><p>Push the corrected history to GitHub:</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git push --force --tags origin <span class=s1>&#39;refs/heads/*&#39;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=7><li>Clean up the temporary clone:</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>cd</span> ..
</span></span><span class=line><span class=cl>rm -rf repo.git
</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-05-08</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/mac%E4%BD%BF%E7%94%A8tar%E5%91%BD%E4%BB%A4%E6%89%93%E5%8C%85%E5%A4%9A%E5%87%BA%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6/ class=prev rel=prev title=Mac使用tar命令打包多出隐藏文件><i class="fas fa-angle-left fa-fw"></i>Mac使用tar命令打包多出隐藏文件</a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.98.0">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=https://simonmy.disqus.com/embed.js defer></script><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:50},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6GP123JQ3E",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-6GP123JQ3E" async></script></body></html>