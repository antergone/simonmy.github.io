<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Changing the Git history of your repository using a script - Simon (Yu Ma)</title><meta name=Description content="Progress is the activity of today and the assurance of tomorrow."><meta property="og:title" content="Changing the Git history of your repository using a script"><meta property="og:description" content="We&rsquo;ve created a script that will change any commits that previously had the old email address in its author or committer fields to use the correct name and email address. Note: Running this script rewrites history for all repository collaborators. After completing these steps, any person with forks or clones must fetch the rewritten history and rebase any local changes into the rewritten history. Before running this script, you&rsquo;ll need:"><meta property="og:type" content="article"><meta property="og:url" content="https://simonmy.com/posts/changing-the-git-history-of-your-repository-using-a-script/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-08T18:00:00+08:00"><meta property="article:modified_time" content="2022-05-08T18:00:00+08:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary"><meta name=twitter:title content="Changing the Git history of your repository using a script"><meta name=twitter:description content="We&rsquo;ve created a script that will change any commits that previously had the old email address in its author or committer fields to use the correct name and email address. Note: Running this script rewrites history for all repository collaborators. After completing these steps, any person with forks or clones must fetch the rewritten history and rebase any local changes into the rewritten history. Before running this script, you&rsquo;ll need:"><meta name=application-name content="Simon (Yu Ma)"><meta name=apple-mobile-web-app-title content="Simon (Yu Ma)"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://simonmy.com/posts/changing-the-git-history-of-your-repository-using-a-script/><link rel=prev href=https://simonmy.com/posts/mac%E4%BD%BF%E7%94%A8tar%E5%91%BD%E4%BB%A4%E6%89%93%E5%8C%85%E5%A4%9A%E5%87%BA%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6/><link rel=next href=https://simonmy.com/posts/cat-match-plug-in/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Changing the Git history of your repository using a script","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/simonmy.com\/posts\/changing-the-git-history-of-your-repository-using-a-script\/"},"genre":"posts","wordcount":234,"url":"https:\/\/simonmy.com\/posts\/changing-the-git-history-of-your-repository-using-a-script\/","datePublished":"2022-05-08T18:00:00+08:00","dateModified":"2022-05-08T18:00:00+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Simon (Yu Ma)"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Simon (Yu Ma)">Simon (Yu Ma)</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Simon (Yu Ma)">Simon (Yu Ma)</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Changing the Git history of your repository using a script</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Simon (Yu Ma)</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/%E6%9D%82%E6%8A%80%E6%B5%85%E5%B0%9D/><i class="far fa-folder fa-fw" aria-hidden=true></i>杂技浅尝</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime="2022-05-08 18:00">2022-05-08 18:00</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 234 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 1 分钟&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents></nav></div></div><div class=content id=content><p>We&rsquo;ve created a script that will change any commits that previously had the old email address in its author or committer fields to use the correct name and email address.</p><blockquote><p>Note: Running this script rewrites history for all repository collaborators. After completing these steps, any person with forks or clones must fetch the rewritten history and rebase any local changes into the rewritten history.</p></blockquote><p>Before running this script, you&rsquo;ll need:</p><p>The old email address that appears in the author/committer fields that you want to change
The correct name and email address that you would like such commits to be attributed to</p><ol><li><p>Open Terminal.</p></li><li><p>Create a fresh, bare clone of your repository:</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git clone --bare https://github.com/user/repo.git
</span></span><span class=line><span class=cl><span class=nb>cd</span> repo.git
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>Copy and paste the script, replacing the following variables based on the information you gathered:</li></ol><ul><li>OLD_EMAIL</li><li>CORRECT_NAME</li><li>CORRECT_EMAIL</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=cp>#!/bin/sh
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl>git filter-branch --env-filter <span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>OLD_EMAIL=&#34;your-old-email@example.com&#34;
</span></span></span><span class=line><span class=cl><span class=s1>CORRECT_NAME=&#34;Your Correct Name&#34;
</span></span></span><span class=line><span class=cl><span class=s1>CORRECT_EMAIL=&#34;your-correct-email@example.com&#34;
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>if [ &#34;$GIT_COMMITTER_EMAIL&#34; = &#34;$OLD_EMAIL&#34; ]
</span></span></span><span class=line><span class=cl><span class=s1>then
</span></span></span><span class=line><span class=cl><span class=s1>export GIT_COMMITTER_NAME=&#34;$CORRECT_NAME&#34;
</span></span></span><span class=line><span class=cl><span class=s1>export GIT_COMMITTER_EMAIL=&#34;$CORRECT_EMAIL&#34;
</span></span></span><span class=line><span class=cl><span class=s1>fi
</span></span></span><span class=line><span class=cl><span class=s1>if [ &#34;$GIT_AUTHOR_EMAIL&#34; = &#34;$OLD_EMAIL&#34; ]
</span></span></span><span class=line><span class=cl><span class=s1>then
</span></span></span><span class=line><span class=cl><span class=s1>export GIT_AUTHOR_NAME=&#34;$CORRECT_NAME&#34;
</span></span></span><span class=line><span class=cl><span class=s1>export GIT_AUTHOR_EMAIL=&#34;$CORRECT_EMAIL&#34;
</span></span></span><span class=line><span class=cl><span class=s1>fi
</span></span></span><span class=line><span class=cl><span class=s1>&#39;</span> --tag-name-filter cat -- --branches --tags
</span></span></code></pre></td></tr></table></div></div><ol start=4><li><p>Press Enter to run the script.</p></li><li><p>Review the new Git history for errors.</p></li><li><p>Push the corrected history to GitHub:</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git push --force --tags origin <span class=s1>&#39;refs/heads/*&#39;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=7><li>Clean up the temporary clone:</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>cd</span> ..
</span></span><span class=line><span class=cl>rm -rf repo.git
</span></span></code></pre></td></tr></table></div></div><div class=post-reward><input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>赞赏支持</label><div class=qr-code><label class=qr-code-image for=reward><img class=image src=https://cos.antergone.com/qrcode/wechat.png>
<span>Wechat</span></label>
<label class=qr-code-image for=reward><img class=image src=https://cos.antergone.com/qrcode/alipay.png>
<span>Alipay</span></label></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-05-08 18:00</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://simonmy.com/posts/changing-the-git-history-of-your-repository-using-a-script/ data-title="Changing the Git history of your repository using a script"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://simonmy.com/posts/changing-the-git-history-of-your-repository-using-a-script/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Hacker News" data-sharer=hackernews data-url=https://simonmy.com/posts/changing-the-git-history-of-your-repository-using-a-script/ data-title="Changing the Git history of your repository using a script"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://simonmy.com/posts/changing-the-git-history-of-your-repository-using-a-script/ data-title="Changing the Git history of your repository using a script"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://simonmy.com/posts/changing-the-git-history-of-your-repository-using-a-script/ data-title="Changing the Git history of your repository using a script"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/mac%E4%BD%BF%E7%94%A8tar%E5%91%BD%E4%BB%A4%E6%89%93%E5%8C%85%E5%A4%9A%E5%87%BA%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6/ class=prev rel=prev title=Mac使用tar命令打包多出隐藏文件><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Mac使用tar命令打包多出隐藏文件</a>
<a href=/posts/cat-match-plug-in/ class=next rel=next title=如何做一只脚本羊>如何做一只脚本羊<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.104.0">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://simonmy.disqus.com/embed.js defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:200},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6GP123JQ3E",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-6GP123JQ3E" async></script></body></html>